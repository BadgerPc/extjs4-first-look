<html>
<head>
<title>Ext JS 4</title>
</head>

	<link rel="stylesheet" type="text/css" href="../../extjs/resources/css/ext-all.css" /> 
    <script type="text/javascript" src="../../extjs/builds/ext-core-debug.js"></script> 
    <script type="text/javascript" src="../../extjs/ext-all-debug-w-comments.js"></script>
    
     <script type="text/javascript" src="../../js/chapter02/demosrc/User.js"></script> 
        <script type="text/javascript" src="../../js/chapter02/demosrc/Post.js"></script> 
        <script type="text/javascript" src="../../js/chapter02/demosrc/Comment.js"></script> 
    
     <script type="text/javascript">
     Ext.onReady(function() {  
	 	
    	 Author.load(1, {
    		    success: function(author) {
    		    	
    		        var books = author.books();
    		        
    		        console.log("Author "+ author.get('name') + " has written " + books.getCount() + " books");
    		        
    		        books.each(function(book) {

    		        	var title = book.get('title');
    		            var chapters = book.chapters();
    		            
    		            console.log("Book " + title + " has " +  chapters.getCount() + " chapters");
    		        	
    		            chapters.each(function(chapter) {
    		            	console.log(chapter.get('number') + " " + chapter.get('title'));
    		            });
    		        });
    		    }
    		});
    	 
    	 Book.load(11, {
    		 success: function(book) {
    			  
    			 book.getAuthor(function (author){
    			 	author.get('name');
    			 });
    			 
    			 book.setAuthor(1);
    			 
    			 book.set('authorId',1);
    			 
    			 book.setCategory(1, function(book, operation) {
    				    console.log(book.get('authorId')); //outputs 1
    				});
    		 }
    	 });
    	 
    	 
     });
     </script> 
<body>
</body>
</html>